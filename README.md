# anonydog

A extremely simple Discord bot designed to facilitate anonymous messaging.

Users operate the bot by sending it DMs. These DMs are forwarded directly to a target channel
on a Discord server. There, users are identified by pseudorandom "anonymous IDs", generated by hashing
their user ID alongside a secret-key value. A pseudorandom "fake name" is also generated, for
human-readability.

Anonymity is guaranteed as long as the server/host itself is secure, and the `anon-nonce` secret-key value
(detailed below) is kept secret.

## Hosting Setup

You must create a `config.edn` file in the root directory (adjacent to this `README.md`).
Its contents should appear as follows (but customized for your use):

```clojure
{:token "DISCORD BOT TOKEN"
 :anon-nonce "INSERT A LONG RANDOM STRING HERE"
 ; THIS FILE MUST NEVER BE SHARED WITH PUBLIC!
 :playing "DM me and say !help"
 :anon-channel-id "CHANNEL ID WHERE DMs SHOULD BE FORWARDED"
 :anon-channel-name "#dms_forward_channel_name"
 :server-name "Placeholder Discord"
 }
```

*IMPORTANT: Keep the anon-nonce value secret. See below.*

Then, run the bot with `lein run`.

### Ensuring Anonymity

The `anon-nonce` value **must** be kept secret. Anyone who gains access to the `anon-nonce`
value can feasibly determine the origin of anonymous messages by brute-force iteration of all
user IDs on a particular server. Do not reveal the `anon-nonce` value.

We recommend periodically changing the `anon-nonce` value - replace it with a new lengthy random
string, then stop (Ctrl+C) and re-run the bot. This changing constitutes an "anonymous IDs
refresh", and all users will gain new anonymous IDs. If previous `anon-nonce` values are not saved/logged, then
a sort of forward secrecy is possible - even if the hosting server is compromised in the future, an attacker
will not be able to determine the identity of past users. For this reason, we recommend periodically changing
the `anon-nonce` value and completely discarding/destroying the previous value.

### NewID Database

When users force new IDs via the `!newid` command, their "original ID" will be given an entry in a
`hasheslist.edn` file in the root directory of the repo. This is normal.
**Do not delete the `hasheslist.edn` file,** unless you are performing an IDs refresh (the aforementioned
changing of the `anon-nonce` value), in which case it's fine (though not necessary) to delete. If
you delete or corrupt the `hasheslist.edn` file, then all ID-changed users will revert back to their original IDs.
This should be avoided!

## Bot Usage

The bot is controlled completely through DMs (direct messages).
To use the bot, just send it a DM saying `!help`. It will explain the rest.

### Details

Any non-command message (not prefixed with `!`) sent to the bot will be anonymously forwarded to the "target channel".

Valid commands:
- `!help` Get help.
- `!myid` Shows you your current anonymous ID.
- `!newid` Force generation of a new anonymous ID for yourself.

## License

Copyright Â© 2020 Nikola Bura

This program and the accompanying materials are made available under the
terms of the Eclipse Public License 2.0 which is available at
http://www.eclipse.org/legal/epl-2.0.

This Source Code may also be made available under the following Secondary
Licenses when the conditions for such availability set forth in the Eclipse
Public License, v. 2.0 are satisfied: GNU General Public License as published by
the Free Software Foundation, either version 2 of the License, or (at your
option) any later version, with the GNU Classpath Exception which is available
at https://www.gnu.org/software/classpath/license.html.
